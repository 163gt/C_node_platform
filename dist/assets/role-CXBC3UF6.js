import{_ as E,r as n,q as G,B as M,j as r,e as X,o as Z,f as h,h as t,w as o,k as f,m as H,n as g,G as J,Z as Q,z as S,X as W}from"./index-DMicvl7E.js";import{P as Y}from"./pagination-BeRdfJKn.js";import{g as ee,u as te}from"./role-C54TQx-G.js";import{_ as ae}from"./dictTag-DbkYWqrS.js";import{F as le,A as U,R as oe}from"./ReturnDownBackOutline-p-vbYhRe.js";import{S as se}from"./SearchCircle-CIxQSjVl.js";const ne={class:"main-content main_body"},re={class:"main_body_content"},ue={class:"header_box"},ie={class:"content_box"},ce={style:{display:"flex"}},de={__name:"role",setup(ve){const B=n(null),N=n(null),i=n(!1),u=n(!1),c=n({title:"添加角色",btn:1}),D=n({roleName:{required:!0,message:"请输入角色名称",trigger:"blur"},roleCode:{required:!0,message:"请输入角色编码",trigger:"blur"}}),v=n({roleName:"",page:1,pageSize:10}),b=n(0),k={roleName:"",roleCode:"",rolePath:[],setRolePath:[],status:1,description:""},s=n({...k}),I=n([{title:"序号",key:"id",render:(a,e)=>`${e+1}`},{title:"角色名称",key:"roleName"},{title:"角色编码",key:"roleCode"},{title:"状态",key:"status",render(a){return S(ae,{dictionaryCode:"sys_status",value:a.status,type:a.status===1?"success":"error",round:!0})}},{title:"操作",key:"action",render(a){return S(W,{round:!0,quaternary:!0,circle:!0,type:"info",onClick:()=>x(a)},{default:()=>"编辑"})}}]),C=n([]),R=n([]),V=a=>{v.value=a,w()},x=a=>{a?(c.value.title="修改角色",c.value.btn=2,s.value=a):(c.value.title="添加角色",c.value.btn=1),i.value=!0},q=()=>{i.value=!1},w=()=>{u.value=!0,m()},F=()=>{s.value={...k}},T=a=>{a.preventDefault(),u.value=!0,N.value?.validate(e=>{if(e)u.value=!1,Nmessage.error("参数校验失败");else switch(c.value.btn){case 1:addroleRouter(s.value).then(d=>{u.value=!1,i.value=!1,m(),Nmessage.success("添加成功！")}).catch(d=>{Nmessage.error(d.message),u.value=!1});break;case 2:te(s.value).then(d=>{u.value=!1,i.value=!1,m(),Nmessage.success("修改成功！")}).catch(d=>{Nmessage.error(d.message),u.value=!1});break}})},m=()=>{ee(v.value).then(a=>{b.value=a.total,R.value=a.data,u.value=!1}).catch(a=>{u.value=!1,Nmessage.error(a.message)}),Q().then(a=>{C.value=a.data})};return G(()=>{m()}),M(i,(a,e)=>{a||(F(),m())}),(a,e)=>{const d=r("n-icon"),z=r("NInput"),_=r("CButton"),L=r("NDataTable"),P=r("n-spin"),y=r("n-input"),p=r("n-form-item"),O=r("n-cascader"),$=r("n-switch"),A=r("n-form"),K=r("n-drawer-content"),j=r("NDrawer");return Z(),X("div",ne,[h("div",re,[h("div",ue,[t(z,{value:v.value.roleName,"onUpdate:value":e[0]||(e[0]=l=>v.value.roleName=l),placeholder:"角色名称",style:{width:"288px"},class:"header_box_item",onKeyup:H(w,["enter"])},{prefix:o(()=>[t(d,{component:f(le)},null,8,["component"])]),_:1},8,["value"]),t(_,{onClick:w,icon:f(se),type:"CSuccess"},{default:o(()=>[...e[9]||(e[9]=[g("搜 索",-1)])]),_:1},8,["icon"]),t(_,{onClick:e[1]||(e[1]=l=>x()),icon:f(U),type:"CPrimary"},{default:o(()=>[...e[10]||(e[10]=[g("添 加",-1)])]),_:1},8,["icon"])]),h("div",ie,[t(P,{show:u.value},{default:o(()=>[t(L,{columns:I.value,data:R.value},null,8,["columns","data"])]),_:1},8,["show"])]),t(Y,{modelValue:v.value,"onUpdate:modelValue":[e[2]||(e[2]=l=>v.value=l),V],total:b.value},null,8,["modelValue","total"])]),t(j,{show:i.value,"onUpdate:show":e[8]||(e[8]=l=>i.value=l),width:"40%"},{default:o(()=>[t(K,{title:c.value.title},{footer:o(()=>[t(P,{show:u.value},{default:o(()=>[h("div",ce,[t(_,{onClick:T,icon:f(U),type:"CPrimary"},{default:o(()=>[g(J(c.value.btn===1?"添 加":"修 改"),1)]),_:1},8,["icon"]),t(_,{onClick:q,icon:f(oe)},{default:o(()=>[...e[11]||(e[11]=[g("取 消",-1)])]),_:1},8,["icon"])])]),_:1},8,["show"])]),default:o(()=>[t(A,{ref_key:"formRef",ref:N,model:s.value,rules:D.value},{default:o(()=>[t(p,{label:"角色名称",path:"roleName"},{default:o(()=>[t(y,{value:s.value.roleName,"onUpdate:value":e[3]||(e[3]=l=>s.value.roleName=l),placeholder:"请输入角色名称"},null,8,["value"])]),_:1}),t(p,{label:"角色编码",path:"roleCode"},{default:o(()=>[t(y,{value:s.value.roleCode,"onUpdate:value":e[4]||(e[4]=l=>s.value.roleCode=l),placeholder:"请输入角色地址"},null,8,["value"])]),_:1}),t(p,{label:"菜单权限",path:"rolePath"},{default:o(()=>[t(O,{ref_key:"cascaderInstRef",ref:B,value:s.value.rolePath,"onUpdate:value":e[5]||(e[5]=l=>s.value.rolePath=l),multiple:"",placeholder:"请选择路由",options:C.value,"label-field":"title","value-field":"id",cascade:!0,"check-strategy":"all","show-path":!0,"max-tag-count":"responsive","allow-checking-not-loaded":!1},null,8,["value","options"])]),_:1}),t(p,{label:"描述",path:"description"},{default:o(()=>[t(y,{value:s.value.description,"onUpdate:value":e[6]||(e[6]=l=>s.value.description=l),type:"textarea",placeholder:"角色描述",autosize:{minRows:3}},null,8,["value"])]),_:1}),t(p,{label:"状态",path:"status"},{default:o(()=>[t($,{"checked-value":1,"unchecked-value":2,value:s.value.status,"onUpdate:value":e[7]||(e[7]=l=>s.value.status=l)},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])])}}},we=E(de,[["__scopeId","data-v-69cc32c4"]]);export{we as default};
